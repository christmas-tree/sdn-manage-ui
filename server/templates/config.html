<!DOCTYPE html>
<html
  xmlns="http://www.w3.org/1999/xhtml"
  xml:lang="utf-8"
  lang="utf-8"
  dir="ltr"
>
  <head>
    <title></title>
    <link href="/static/ont.css" rel="stylesheet" type="text/css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <div
        style="
          margin-left: 20%;
          display: flex;
          flex-wrap: inherit;
          align-items: center;
        "
      >
        <a class="navbar-brand" href="#">Network Admin UI</a>
        <div>
          <ul class="navbar-nav me-auto mb-2 mb-lg-0 d-flex">
            <li class="nav-item">
              <a
                class="nav-link"
                aria-current="page"
                href="{{ url_for('topology')}}"
                >Topology</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="{{ url_for('config')}}"
                >Configuration</a
              >
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <div id="wrapper">
      <div id="content_right">
        <h1 id="content_title">Configuration</h1>
        <div class="alert alert-success">abcdef</div>
        <div id="cfgarea">
          <div class="cfgstep">
            <p><strong>Flows</strong></p>
            <div style="margin: 20px 0">
              <p style="text-indent: unset">Add flow</p>
              <table>
                <tbody>
                  <tr>
                    <td width="200">Switch</td>
                    <td>
                      <select>
                        <option value="0">HGU</option>
                        <option value="1">SFU</option>
                      </select>
                    </td>
                  </tr>
                  <tr>
                    <td width="200">In Port</td>
                    <td>
                      <input type="number" value="1" />
                    </td>
                  </tr>
                  <tr>
                    <td width="200">Out Port</td>
                    <td>
                      <input type="number" value="1" />
                    </td>
                  </tr>
                  <tr>
                    <td width="200">Source MAC</td>
                    <td>
                      <input type="text" value="1" />
                    </td>
                  </tr>
                  <tr>
                    <td width="200">Destination MAC</td>
                    <td>
                      <input type="text" value="1" />
                    </td>
                  </tr>
                </tbody>
              </table>
              <button class="btn" style="margin-left: 20px">Add flow</button>
            </div>
            <hr />
            <div style="margin-top: 30px">
              <p style="text-indent: unset">Delete flow</p>
              <table>
                <tbody>
                  <tr>
                    <td width="200">Switch</td>
                    <td>
                      <select>
                        <option value="0">All</option>
                        <option value="1">SFU</option>
                        <option value="1">SFU</option>
                        <option value="1">SFU</option>
                        <option value="1">SFU</option>
                      </select>
                    </td>
                  </tr>
                </tbody>
              </table>
              <a class="btn" href="#" id="save" style="margin-left: 20px">
                Delete flows</a
              >
            </div>
          </div>
          <div class="cfgstep">
            <p><strong>Route</strong></p>
            <div style="margin: 20px 0">
              <p style="text-indent: unset">Use Dijkstra</p>
              <table>
                <tbody>
                  <tr>
                    <td width="200">Source</td>
                    <td>
                      <select>
                        <option value="0">HGU</option>
                        <option value="1">SFU</option>
                      </select>
                    </td>
                  </tr>
                  <tr>
                    <td width="200">Destination</td>
                    <td>
                      <select>
                        <option value="0">HGU</option>
                        <option value="1">SFU</option>
                      </select>
                    </td>
                  </tr>
                  <tr>
                    <td width="200">Type</td>
                    <td>
                      <input
                        type="radio"
                        value="pubic"
                        checked="checked"
                        name="mode"
                        id="mode-public"
                      />
                      <label for="mode-public">Public</label>
                      <input
                        type="radio"
                        value="private"
                        name="mode"
                        id="mode-private"
                      />
                      <label for="mode-private">Private</label>
                    </td>
                  </tr>
                </tbody>
              </table>
              <a class="btn" href="#" id="save" style="margin-left: 20px">
                Find Route</a
              >
            </div>
            <hr />
            <div style="margin-top: 30px">
              <p style="text-indent: unset">Custom path</p>
              <table>
                <tbody>
                  <tr>
                    <td width="200">Switch</td>
                    <td>
                      <div style="display: block" id="path-container">
                        <select onchange="onChangeSelect(this);">
                          <option></option>
                          <option value="s1">s1</option>
                          <option value="s2">s2</option>
                          <option value="s3">s3</option>
                          <option value="s4">s4</option>
                        </select>
                      </div>
                      <div style="margin-top: 10px" id="path-preview"></div>
                      <input
                        type="text"
                        style="display: none"
                        id="path-list"
                        value=""
                      />
                    </td>
                    <script>
                      const pathContainerDiv =
                        document.getElementById("path-container");
                      const pathPreviewDiv =
                        document.getElementById("path-preview");
                      const pathListElement =
                        document.getElementById("path-list");
                      let pathList = [];
                      const data = {
                        s1: ["s2", "s3"],
                        s2: ["s3", "s1", "s5"],
                        s3: ["s4"],
                        s4: ["s5", "s2"],
                      };

                      function renderPath() {
                        const selects =
                          pathContainerDiv.getElementsByTagName("select");
                        pathList = [];
                        for (const select of selects) {
                          if (select === selects[selects.length - 1]) {
                            break;
                          }
                          pathList.push(select.value);
                        }
                        console.log(pathList);
                        pathListElement.value = pathList.join(",");
                        pathPreviewDiv.textContent = pathList.join(" â†’ ");
                      }

                      function onChangeSelect(target) {
                        const selects =
                          pathContainerDiv.getElementsByTagName("select");
                        let i;
                        for (i = 0; i < selects.length; i++) {
                          if (selects[i] === target) {
                            break;
                          }
                        }
                        i++;
                        while (selects[i]) {
                          selects[i].remove();
                        }

                        const newSelect = document.createElement("select");
                        newSelect.onchange = () => onChangeSelect(newSelect);
                        const child = document.createElement("option");
                        newSelect.appendChild(child);
                        if (data[target.value]) {
                          for (const connectedNode of data[target.value]) {
                            if (pathList.includes(connectedNode)) {
                              continue;
                            }
                            const option = document.createElement("option");
                            option.value = connectedNode;
                            option.text = connectedNode;
                            newSelect.appendChild(option);
                          }
                        }
                        pathContainerDiv.appendChild(newSelect);

                        renderPath();
                      }
                    </script>
                  </tr>
                </tbody>
              </table>
              <a class="btn" href="#" style="margin-left: 20px"> Set Route</a>
            </div>
          </div>
        </div>
      </div>
      <div id="footer">Nhom 1. Mang SDN.</div>
    </div>
  </body>
</html>
